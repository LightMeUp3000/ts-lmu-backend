import 'jest';
import * as request from 'supertest';
import { app } from '../src/index';

const CONTROLLER_URL = '/v1/picture';
const CORRECT_BODY_PNG = {
  "image": "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"
}
const CORRECT_BODY_JPG = {
  "image": "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"
}

describe('POST ' + CONTROLLER_URL, () => {
  test('/png/10/10 with correct body respond with status 200', (done) => {
    request(app)
      .post(CONTROLLER_URL + '/png/10/10')
      .send(CORRECT_BODY_PNG)
      .set('Accept', 'application/json')
      .expect(200, done);
  })

  test('/jpg/10/10 with correct body respond with status 200', (done) => {
    request(app)
      .post(CONTROLLER_URL + '/jpg/10/10')
      .send(CORRECT_BODY_JPG)
      .set('Accept', 'application/json')
      .expect(200, done);
  })

  test('/jpg/10/10 with bad body respond with status 400', (done) => {
    request(app)
      .post(CONTROLLER_URL + '/jpg/10/10')
      .send({
        "image": false
      })
      .set('Accept', 'application/json')
      .expect(400, done);
  })

  test('/aaa/10/10 with correct body respond with status 400', (done) => {
    request(app)
      .post(CONTROLLER_URL + '/aaa/10/10')
      .set('Accept', 'application/json')
      .expect(400, done);
  })

  test('/jpg/2137/10 with correct body respond with status 400', (done) => {
    request(app)
      .post(CONTROLLER_URL + '/jpg/2137/10')
      .set('Accept', 'application/json')
      .expect(400, done);
  })

  test('/jpg/10/2137 with correct body respond with status 400', (done) => {
    request(app)
      .post(CONTROLLER_URL + '/jpg/10/2137')
      .set('Accept', 'application/json')
      .expect(400, done);
  })
})